<!DOCTYPE html>
<html lang="pt-BR">

<head>

    <meta charset="UTF-8">
    <meta name="author" content="Erivelton Silva">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- displays site properly based on user's device -->

    <title>Frontend Mentor | Advice generator app</title>
    <link rel="icon" type="image/png" sizes="32x32" href="./dist/images/favicon-32x32.png">

    <!-- Feel free to remove these styles or customize in your own stylesheet üëç -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
        integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw=="
        crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="./dist/css/main.min.css">

    <!-- Vue.js -->
    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

</head>


<body>

    <main id="app">

        <div class="card">

            <section class="card__body" v-if="data">

                <h1 class="card__title">
                    Advice #{{ data.slip.id }}<i @click="copyText" class="fa-regular fa-copy card__icon"
                        title="button to copy advice"></i>
                </h1>
                <p class="card__text js-copiedText" ref="advice">
                    ‚Äú{{ this.advice }}‚Äù
                </p>

            </section>

            <div class="card__img"></div>

            <footer class="card__footer">
                <button class="btn" @click="getAdvice" aria-label="buscar conselhos">
                    <img src="./dist/images/icon-dice.svg" alt="">
                </button>
            </footer>

        </div>

    </main>


    <footer class="attribution">
        Challenge by <a href="https://www.frontendmentor.io?ref=challenge" target="_blank">Frontend Mentor</a>.
        Coded by <a href="https://www.instagram.com/erivelton.dsilva/">Erivelton Silva</a>.
    </footer>


    <!-- Inst√¢ncia do Vue.js -->
    <script>

        const { createApp } = Vue;


        const app = createApp({

            data() {
                return {

                    data: null,
                    advice: null,
                };
            },


            methods: {

                /// fun√ß√£o para consumir api e guardar as info em 'data'
                async getAdvice() {

                    const response = await fetch('https://api.adviceslip.com/advice');
                    this.data = await response.json();
                },

                /// Fun√ß√£o para copiar texto do advice e exibir mensagem na tela de confirma√ß√£o
                copyText() {

                    navigator.clipboard.writeText(this.advice);
                    alert('Copied the text:\n' + this.advice);
                },
            },


            watch: {

                /// fun√ß√£o para colocar letra por letra do advice na tela
                data() {

                    let text = this.data.slip.advice.split('');
                    this.advice = '';

                    text.forEach((letter, i) => {
                        setTimeout(() => this.advice += letter, 70 * i)
                    });
                },
            },


            mounted() {

                /// fun√ß√£o declarada para adicionar o primeiro advice quando o app √© aberto
                this.getAdvice();
            },
        });

        app.mount('#app');

    </script>

</body>

</html>